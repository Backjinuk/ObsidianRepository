- 기본형과 참조형의 공유

- 기본형 : 하나의 값을 여러 변수에서 절대로 공유하지 않는다

- 자바는 항상 값을 복사해서 대입한다.
- 값 자체를 복사후 대입
- 값을 변경해도 변수의 값만 변경됨  

- 참조형  : 하나의 객체를 참조값을 통해 여러 변수에서 공유할수 있다.

- 참조형 변수들은 같은 참조값을 통해 같은 인스턴스를 참조할수 있다.

- 즉 참조값은 메모리상에 저장이되고 그 주소값을 변수에 넣기 때문에 값을 공유하는 할 수 있다.

  

- 공유참조와 사이드 이펙트
- 주된 작업외에 추가적인 부수 효과를 일으키는 것 (버그 발생 가능성이 높아짐)
- 참조형에서 발생하는 사이드 이펙트를 처리할수 있는 방법

- 서로 다른 인스턴스를 참조 하면됨

- 참조값의 공유를 막을 수 있는 방법이 없다.
- 간단한 코드에서는 찾을수 있지만 복잡한 코드에서는 디버깅하기 힘들다.

- 개발자가 공유 참조 문제가 발생하지 않도록 주의해야할까?? 아마 쉽지 않을듯

- 불변 객체 - 도입
- 위의 문제의 근본은 공유괸 객체의 값을 변경하는 것에 있음
- 객체의 상태(객체 내부의 값, 필드, 맴버 변수)가 변하지 않는 객체를 불변 객체라고 한다.
- 불변 객체 라도 참조값 공유를 막을수 있는건 아니다

- 하지만 참조 공유된 객체의 값을 바꾸는 것은 불가능하다
- 고로 근본적인 문제인 공유된 객체의 값을 변경하는 것을 막을수 있다.

- 불변 객체 이지만 기존값을 변경해야 하는 메서드가 필요할수도 있다. 이때는 기존객체의 값은 그대로두고 대신 변경된 값을 새로운 불변 객체에 담아서 반환하면 된다.

- 불변 객체 관련 메서드들은 보통 새로운 객체를 반환하기 때문에 반환값은 꼭 받아야 한다.

  

- 정리

- 객체의 공유 참조는 막을 수 없다. 
- 객체의 값을 변경하면 다른 곳에서 참조하는 변수의 값도 함께 변경되는 사이드 이펙트가 발생한다. 
- 사이드 이펙트가 발생하면 안되는 상황이라면 불변 객체를 만들어서 사용하면된다. 
- 불변객체는 객체의 값을 변경할수 없기 때문에 사이드 이펙트의 원인이 원천 차단된다. 
- 만약 불변객체의 값을 변경해야한다면 그냥 새로운 인스턴스를 만들어서 대입하면 된다
- String, Integer, LocalDate등이 불볍 객체이다.